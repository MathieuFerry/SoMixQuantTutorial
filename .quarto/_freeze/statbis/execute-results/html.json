{
  "hash": "4bc0a4dd5bc24dddde9b1b555e1ed0f6",
  "result": {
    "engine": "knitr",
    "markdown": "# Statistiques bivariées et graphiques\n\nDans ce chapitre, nous abordons maintenant les statistiques bivariées. Nous utilisons toujours la base edu.rds et les mêmes packages que dans le chapitre précédent. \n\n::: {.callout-note title=\"Exercice\"}\n-   Create an empty R script. \n\n-   Save this script in a folder (for instance, \"WinterWorkshop\") and name it for instance \"3Statbis.R\". \n\n-   Load the edu database and run the commands below to install/load packages.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# On liste les packages dont on a besoin dans un vecteur nommé load.lib. \nload.lib <- c(\"tidyverse\",\"questionr\",\"Hmisc\",\"esquisse\",\"kableExtra\") \ninstall.lib <- load.lib[!load.lib %in% installed.packages()] # On regarde les paquets qui ne sont pas installés\nfor (lib in install.lib) install.packages(lib,dependencies=TRUE) # On installe ceux-ci\nsapply(load.lib,require,character=TRUE) # Et on charge tous les paquets \n\n\n\nsetwd(\"/home/groups/3genquanti/SoMix/HIES for workshop\")\nedu<-readRDS(\"edu.rds\")\n```\n:::\n\n\n\n:::\n\n\n## The association between a categorical variable and a numerical variable \n\n\nIn the chapter on univariate statistics, we discussed several indicators of the distribution of a numerical variable (minimum, maximum, mean, median). Thanks to the lines of code already set up, it is very easy to calculate these statistics for different categories of another categorical variable.\n\nYou simply need to add another function to compute these statistics for each category of a variable, namely `group_by`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu |>\n  group_by(province) |>\n  summarise(\n    min    = min(distance, na.rm = TRUE),\n    mean   = wtd.mean(distance,weights=finalweight_25per,na.rm = TRUE),\n    median = wtd.quantile(distance,probs=.5,weights=finalweight_25per,na.rm = TRUE),\n    max    = max(distance, na.rm = TRUE),\n    n_na   = sum(is.na(distance))\n  )\n```\n:::\n\n\n\n\nLet’s study the distance to school according to the place of residence: urban, rural, or estate. This corresponds to the variable sector, with categories 1, 2, and 3. We can recode these categories using the icut() interface, or directly with the following code:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu$sector_rec <- edu$sector  |>\n  as.character() |>\n  fct_recode(\n    \"Urban\" = \"1\",\n    \"Rural\" = \"2\",\n    \"Estate\" = \"3\"\n  )\n\nedu |>\n  group_by(sector_rec) |>\n  summarise(\n    min    = min(distance, na.rm = TRUE),\n    mean   = wtd.mean(distance,weights=finalweight_25per,na.rm = TRUE),\n    median = wtd.quantile(distance,probs=.5,weights=finalweight_25per,na.rm = TRUE),\n    max    = max(distance, na.rm = TRUE),\n    n_na   = sum(is.na(distance))\n  )\n```\n:::\n\n\n\n\nNothing prevents us from studying variations in the distance to school according to several categorical variables. For example, we can compute the mean and the median with respect to both the province and the place of residence:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu |>\n  group_by(province,sector_rec) |>\n  summarise(\n    mean   = wtd.mean(distance,weights=finalweight_25per,na.rm = TRUE),\n    median = wtd.quantile(distance,probs=.5,weights=finalweight_25per,na.rm = TRUE)\n  ) |> \n  kbl(digits=1) |> kable_classic(full_width = F)\n```\n:::\n\n\n\n![Urban-rural gap in distance to school by province](images/Capture d’écran 2025-11-21 à 21.58.25.png){fig-align=\"center\"}\n\nThe distance to school tends to be higher in rural areas, and this difference is mainly driven by extreme values. Indeed, it is primarily the mean, which is more sensitive to large values, that reflects this gap, more so than the median.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu |>\n  group_by(province,sector_rec) |>\n  summarise(\n    mean   = wtd.mean(distance,weights=finalweight_25per,na.rm = TRUE) \n  ) |> \n  pivot_wider(names_from=sector_rec,values_from=mean) |>\n  mutate(`Urban-Rural difference`=Urban-Rural) |>\n  kbl(digits=1) |> kable_classic(full_width = F)\n```\n:::\n\n\n\n\n![Urban-rural gap in distance to school by province](images/Capture d’écran 2025-11-21 à 21.57.52.png){fig-align=\"center\"}\n\n\nWe can clearly see from this last analysis that this pattern holds in all provinces (except North Western), but the gap varies: it is higher in the Sabaragamuwa and Southern provinces, where the distance to school for children in estate areas is particularly pronounced.\n\n### Résumer par la moyenne et l'écart-type\n\nIt is quite common in academic articles to describe quantitative variables by reporting the mean (a measure of central tendency) and the standard deviation (a measure of dispersion, equal to the square root of the variance).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu |>\n  group_by(sector_rec) |>\n  summarise(\n    mean= mean(distance,na.rm=T),\n    sd= sd(distance,na.rm=T),\n  ) |>\n  kbl(digits=1) |> kable_classic(full_width = F)\n```\n:::\n\n\n\n\n![Mean and standard deviation of distance to school by residence](images/Capture d’écran 2025-11-21 à 22.06.22.png){fig-align=\"center\"}\n\nWhy are these two indicators used? First, we can say from this table that, on average, the distance to school is higher for children in rural areas than in urban areas. There is also greater variability in the distance to school in rural areas (sd stands for standard deviation).\n\n::: callout-tip\nShould we summarize a variable by its mean or its median?\n\nThe first option is very common (especially in English-language journals) but is not necessarily the most appropriate…\n\nWhen working with skewed (i.e., non-normal) distributions:\n\n-   The mean is sensitive to extreme values in the distribution.\n-   It may be best to have a look at both and plot the distributions! \n\nNote: in fact, the standard deviation is then also not really a reliable indicator of dispersion describing the distribution. One may then prefer to calculate quantiles (e.g. quartiles, following Tukey's 5 number summary!). \n\n:::\n\n\n::: {.callout-note title=\"Exercise\" icon=\"false\"}\nUsing esquisser, reproduce the following plot. Try to improve it by playing with color palettes, font sizes...\n\nWhat is your take away from this plot and from the previous statistics? \n\n![Density of the distance to school by residence location](images/esquisse-plot.png){fig-align=\"center\"}\n:::\n\n\n## The association between two categorical variables and the cross-tabulation\n\n### Some conventions for cross-tabulations\n\nWe now come to cross-tabulations to study the associations between two categorical variables.\n\nFirst, let's recall a few analysis conventions. It’s easy to get confused when creating cross-tabulations, so keep the following points in mind:\n\n-   What is my *response variable* or *dependent variable*, i.e., the variable assumed to depend on another factor?\n\n\n-   What is my *independent variable*, i.e., the variable assumed to have an effect on the dependent variable?\n\nOn peut par exemple ici supposer que le fait d'être actuellement scolarisé (variable r2_school_education) dépend du niveau de diplôme des parents, mais aussi de leur niveau économique, du lieu de résidence, etc. \n\n-   To visualize whether a factor affects a dependent variable, we can create a cross-tabulation in which:\n\n-   The dependent variable is placed in the columns.\n\n-   The independent variable is placed in the rows.\n\n-   Row percentages are calculated (we need to normalize the row counts to compare them!).\n\n-   We then compare the rows within the same column.\n\nOf course, this is theory. \n\nThere are many cases where we might be more interested in column percentages, or even total percentages, or we may want to swap rows and columns. Nevertheless, keeping these simple conventions in mind helps to stay oriented when navigating statistical analyses.\n\n### Practical application of the cross-tabulation\n\nNous retrouvons les fonctions du package questionr. Pour créer un tableau croisé des effectifs non pondérés, on pourra écrire :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu$r2_school_education_rec <- edu$r2_school_education  |>\n  as.character() |>\n  fct_recode(\n    \"Currently attending\" = \"1\",\n    \"Never attended\" = \"2\",\n    \"Attended school in the past\" = \"3\"\n  )\n\nedu |> freqtable(edu_parents,r2_school_education_rec)\n```\n:::\n\n\n\n\nLa variable en ligne (ici, race) est la variable indépendante, c'est la première à être écrire, tandis que la variable en colonne (ici, salaire_quint) est la variable dépendante.\n\nPour obtenir des pourcentages en ligne, il suffit d'écrire :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalaires |> freqtable(race,salaire_quint) |> rprop()\n```\n:::\n\n\n\n\nDans ce tableau, on peut aussi ajouter les effectifs totaux des lignes et par exemple ne pas mettre de décimales après la virgule :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalaires |> freqtable(race,salaire_quint) |> rprop(n=T,digit=0)\n```\n:::\n\n\n\n\nBien sur, il est possible de réaliser un tableau des pourcentages en colonne :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalaires |> freqtable(race,salaire_quint) |> cprop(n=T,digit=0)\n```\n:::\n\n\n\n\nOu des pourcentages totaux (qu'on appelle aussi pourcentages conjoints) :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalaires |> freqtable(race,salaire_quint) |> prop(n=T,digit=0)\n```\n:::\n\n\n\n\n::: {.callout-note title=\"Exercice\" icon=\"false\"}\n1.  Étudier le lien entre le sexe et le niveau de salaire.\n\n2.  Réaliser un tableau dans le Viewer.\n:::\n\n### Le tableau et son graphique\n\nON GARDE\n\nOn peut aussi réaliser un diagramme à barres empilées ou adjacentes de l'association entre la catégorie raciale et le niveau de salaire :\n\n![Graphique à barres avec Esquisse](images/clipboard-2502740168.png)\n\nON ENLEVE\n\nOn pourrait améliorer ce graphique de deux manières :\n\n-   En inversant l'ordre des étiquettes empilées (Très élevé en haut, très faible en bas)\n\n-   En mettant l'axe des Y en pourcentages (attention, il faut avoir installer le package scales)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Salaires) +\n  aes(x = race, fill = fct_rev(salaire_quint)) +  # Inverser l'ordre d'empilement\n  geom_bar(position = \"fill\") +\n  scale_y_continuous(labels = scales::percent_format()) + # Axe des Y en % avec package scales\n  scale_fill_brewer(palette = \"PuRd\", direction = -1,\n                    guide = guide_legend(reverse = TRUE)) +  # Légende dans le bon ordre\n  labs(\n    x = \"Catégorie raciale\",\n    y = \"Pourcentage\",\n    fill = \"Quintile de salaire\"\n  ) +\n  theme_light() +\n  theme(\n    legend.position = \"bottom\",\n    axis.title.y = element_text(size = 18L),\n    axis.title.x = element_text(size = 18L),\n    axis.text.y = element_text(size = 18L),\n    axis.text.x = element_text(size = 18L),\n    legend.text = element_text(size = 18L),\n    legend.title = element_text(size = 18L)\n  )\n```\n:::\n\n\n\n\n![Graphique à barres empilées amélioré](images/clipboard-2683344242.png)\n\n::: {.callout-tip title=\"Bonus 1\" collapse=\"true\"}\nOn peut vouloir plutôt réaliser un diagramme à barres adjacentes plutôt que empilées. Dans ce cas, il est plus simple de repartir du tableau des pourcentages en ligne :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#On crée le tableau croisé avec % en ligne\ntab <- Salaires |>\n  freqtable(race, salaire_quint) |>\n  rprop(total=F) #On enlève les % totaux\n\n# Il faut transformer ce tableau en format tidy pour le graphique\ndf_tab <- as.data.frame.matrix(tab) |> #transformation en une matrice de format data.frame\n  rownames_to_column(\"race\") |> #Les lignes étaient des \"row.names\" auxquelles on assigne un nom de colonne\n  pivot_longer(\n    cols = -race,\n    names_to = \"salaire_quint\",\n    values_to = \"pct\"\n  ) #On transforme le tableau de telle sorte que tous les % soient dans la même colonne et les modalités de salaire également. \ndf_tab$salaire_quint <- df_tab$salaire_quint |>\n  fct_relevel(\n    \"Très faible\",\"Faible\",\"Moyen\",\"Elevé\",\"Très élevé\"\n  )\n\nggplot(df_tab, aes(x = salaire_quint, y = pct / 100, fill = race)) +\n  geom_bar(stat = \"identity\",position = position_dodge2(width = 0.9,preserve=\"single\"))+\n  geom_text(aes(label = paste0(round(pct,0), \"%\")),\n             position = position_dodge2(width = 0.9,preserve=\"single\"),\n             vjust=-.3,\n             size = 5) +\n  scale_y_continuous(lim=c(0,.45),labels = scales::percent_format(accuracy = 1)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = -1,\n                    guide = guide_legend(reverse = T)) +\n  labs(\n    x = \"Quintile de salaire\",\n    y = \"Pourcentage\",\n    fill = \"Catégorie raciale\"\n  ) +\n  theme_light() +\n  theme(\n    legend.position = \"bottom\",\n    axis.title.y = element_text(size = 18L),\n    axis.title.x = element_text(size = 18L),\n    axis.text.y = element_text(size = 18L),\n    axis.text.x = element_text(size = 18L),\n    legend.text = element_text(size = 18L),\n    legend.title = element_text(size = 18L)\n  )\n```\n:::\n\n\n\n\n![Diagramme à barres adjacentes](images/clipboard-1796684723.png)\n:::\n\n::: {.callout-tip title=\"Bonus 2\" collapse=\"true\"}\nOn pourrait aussi vouloir créer un diagramme à barres avec les étiquettes de valeurs de pourcentage sur le graphique. Dans ce cas, il est plus simple de repartir du tableau des pourcentages en ligne :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#On crée le tableau croisé avec % en ligne\ntab <- Salaires |>\n  freqtable(race, salaire_quint) |>\n  rprop()\n\n# Il faut transformer ce tableau en format tidy pour le graphique\ndf_tab <- as.data.frame.matrix(tab) |> #transformation en une matrice de format data.frame\n  rownames_to_column(\"race\") |> #Les lignes étaient des \"row.names\" auxquelles on assigne un nom de colonne\n  select(-Total) |> #On enlève les lignes de total\n  pivot_longer(\n    cols = -race,\n    names_to = \"salaire_quint\",\n    values_to = \"pct\"\n  ) #On transforme le tableau de telle sorte que tous les % soient dans la même colonne et les modalités de salaire également. \ndf_tab$salaire_quint <- df_tab$salaire_quint |>\n  fct_relevel(\n    \"Très faible\",\"Faible\",\"Moyen\",\"Elevé\",\"Très élevé\"\n  )\n\n# Graphique\nggplot(df_tab, aes(x = race, y = pct / 100, fill = fct_rev(salaire_quint))) +\n  geom_bar(stat = \"identity\") +\n  geom_label(aes(label = paste0(round(pct,0), \"%\")),\n            position = position_stack(vjust = 0.5),\n            size = 5) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  scale_fill_brewer(palette = \"PuRd\", direction = -1,\n                    guide = guide_legend(reverse = T)) +\n  labs(\n    x = \"Catégorie raciale\",\n    y = \"Pourcentage\",\n    fill = \"Quintile de salaire\"\n  ) +\n  theme_light() +\n  theme(\n    legend.position = \"bottom\",\n    axis.title.y = element_text(size = 18L),\n    axis.title.x = element_text(size = 18L),\n    axis.text.y = element_text(size = 18L),\n    axis.text.x = element_text(size = 18L),\n    legend.text = element_text(size = 18L),\n    legend.title = element_text(size = 18L)\n  )\n```\n:::\n\n\n\n\n![Diagramme à barres empilées avec étiquettes](images/clipboard-3779074093.png)\n:::\n\n::: {.callout-note title=\"Exercice\" icon=\"false\"}\nÉtudier le lien entre sexe et niveau de salaire à l'aide d'un diagramme à barres empilées ou adjacentes.\n:::\n\n### La force de l'association\n\nON ENLEVE\n\nPour étudier l'intensité de l'association entre deux variables qualitatives, l'indice le plus évident est le V de Cramer qui prend une valeur entre 0 (pas d'association) et 1 (association parfaite).\n\nÀ partir de 0,2 ou 0,3, on pourra considérer qu'il y a une association notable.\n\nOn le calcule ainsi :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- Salaires |>\n  freqtable(race, salaire_quint)\ncramer.v(tab)\n```\n:::\n\n\n\n\n::: {.callout-note title=\"Exercice\" icon=\"false\"}\nL'intensité de l'association est-elle plus forte pour entre le salaire et le sexe ou le salaire et la catégorie raciale ?\n:::\n\n### Un mot sur le test du khi-deux\n\nON DEPLACE PLUS LOIN\n\nDifficile de ne pas évoquer pour finir le test du chi-deux, sans toutefois trop s'y attarder. Précisons que Julien Barnier a écrit un [récapitalutif très exhaustif](https://raw.githubusercontent.com/juba/archive_doc_khi2/master/khi2.pdf) sur ce qu'est et n'est pas le test du khi-deux (ou chi-deux ou \\chi-deux ou chi-squared...).\n\nÀ quoi sert le test du khi-deux :\n\n-   Déterminer la probabilité que les lignes et les colonnes du tableau croisé sont indépendantes\n\n-   Évaluer si la répartition des effectifs dans une table de contingence est significativement différente de la table calculée sous l’hypothèse d’indépendance des deux variables croisées\n\n*La distribution du salaire est-elle indépendante de celle de la catégorie raciale des individus ? Y-a-t-il une association entre race et salaire ?*\n\n::: {.callout-note title=\"Explications sur le test du khi-deux\" collapse=\"true\"}\nOn va poser un test statistique, avec une hypothèse H0, ou hypothèse nulle qui est que :\n\n*La distribution des quintiles de salaire est indépendante de la catégorie raciale.*\n\nOn cherche à savoir à quoi ressemblerait notre tableau croisé si les deux variables étaient effectivement indépendantes l'une de l'autre et quelle est la probabilité (la p-valeur) pour que les deux variables soient effectivement indépendantes l'une de l'autre, modulo nos fluctuations d'échantillonnage.\n\nEn pratique, les variables sont indépendantes si :\n\n-   Les pourcentages lignes du tableau croisé sont les mêmes pour toutes les lignes\n\n-   Les pourcentages colonnes du tableau croisé sont les mêmes pour toutes les colonnes\n\nDans notre exemple, lignes et colonnes ne semblent pas très indépendantes.\n\nMais dans un échantillon issu d'une enquête, il est rare que les variables croisées soient parfaitement indépendantes car les données du tableau sont dépendantes de l'échantillon interrogé et tout échantillon est soumis à des biais (qui, si l'échantillon a été construit de manière aléatoire, sont dus *au hasard,* donc des *fluctuations d'échantillonage*).\n\nLe test du khi-deux permet de savoir à partir de quel seuil on peut estimer que les variations observées par rapport à la situation d'indépendante sont dues au hasard et à partir de quand elles sont dues à un lien entre les variables.\n\nÀ partir du tableau des effectifs, on peut calculer les effectifs théoriques, *si les deux variables étaient indépendantes*, grâce aux marges des lignes et des colonnes :\n\n*Effectif théorique d'une cellule = (total ligne x total colonne) / total global*\n\nCe qu'on peut calculer manuellement à partir des marges (les totaux) qu'on peut obtenir par exemple en faisant ainsi :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalaires |>\n  freqtable(race, salaire_quint) |>\n  prop(n=T)\n```\n:::\n\n\n\n\nL'effectif théorique de la cellule Blanc x Très faible est donc 90,6 car :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n110*440/534\n```\n:::\n\n\n\n\nHeureusement R dispose de la fonction chisq.test() qui permet notamment d'afficher les effectifs théoriques :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab<-Salaires |>\n  freqtable(race, salaire_quint)\nchi<-chisq.test(tab)\nchi$expected\n```\n:::\n\n\n\n\nPour mémoire les effectifs observés sont :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi$observed\n```\n:::\n\n\n\n\nAlors à quel point les effectifs théoriques divergent des effectifs observés ?\n\nPour ce faire, on calcule des \"khi-deux partiels\" définis comme la distance standardisée entre les effectifs théoriques et observés :\n\n![Définition des khi-deux partiels](images/clipboard-1078637929.png)\n\nCes khi-deux partiels peuvent être calculés comme ceci :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(chi$expected-chi$observed)^2/chi$expected\n```\n:::\n\n\n\n\n![Khi-deux partiels](images/clipboard-2425509646.png)\n\nIci, on voit déjà que les écarts à l'indépendance sont les plus élevés pour la cellule HispaniquexTrès faible, ce que nous avions repéré avec une surreprésentation de cette catégorie raciale parmi ceux qui gagnent de faibles salaires.\n\nOn calcule ensuite la valeur du khi-deux du tableau, qui correspond à la somme des khi-deux partiels :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((chi$expected-chi$observed)^2/chi$expected)\n```\n:::\n\n\n\n\nQu'on obtient aussi ici :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi$statistic\n```\n:::\n\n\n\n\nEst-ce que cette valeur est faible ou élevée ?\n\nOn va pouvoir comparer cette statistique à la \"loi du khi-deux\", une distribution statistique qui nous donne les valeurs théoriques du khi-deux d'un tableau sous condition d'indépendance.\n\nCette loi dépend d'un paramètre : le nombre de degrés de libertés. Quel est le nombre de degrés de libertés ici ?\n\nIl dépend grosso modo de la taille du tableau :\n\n*(Nombre de lignes - 1) x (Nombre de colonnes - 1)*\n\nIci, nous avons 3 lignes et 5 colonnes, donc le degré de liberté (ddl) est égal à 8.\n\nOn le vérifie ici :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi$parameter\n```\n:::\n\n\n\n\n![Loi du khi-deux suivant le degré de libertés (k)](images/clipboard-4241100990.png)\n\nOn va enfin calculer une probabilité (une p-valeur), qui correspond à l'aire sous la courbe théorique à droite de la valeur du khi-deux observée, qui ici vaut 0,397, comme indiqué sur la figure.\n\nEn effet, rappelons-nous, la p-valeur c'est la probabilité que le khi-2 théorique soit supérieur ou égal au khi-2 observé sous condition d'indépendance.\n\nIci, on voit que si les deux variables sont indépendantes, il y a une probabilité de presque 40 % pour que par hasard on obtienne une valeur du khi-2 au moins aussi élevée que celle qu'on a observé (8,374).\n\nAutrement dit, notre valeur du khi-deux est assez plausible / compatible avec le fait que les deux variables soient indépendantes !\n\nCette p-valeur nous empêche de rejeter l'hypothèse d'indépendance entre catégorie racial et salaire.\n\n*En sciences sociales, on retient généralement le seuil d'une p-valeur de 0,05 en dessous de laquelle on estime qu'on peut rejeter l'hypothèse d'indépendance.*\n\nPour ce faire, il aurait fallu ici obtenir un khi-2 observé au moins égal à 15,507 (on en est loin !).\n\n![Distribution du khi-2 et p-valeur](images/clipboard-3821422757.png)\n\nAlors que conclure ? On ne rejette pas H0, l'hypothèse d'indépendance.\n\nMais pouvons-nous affirmer que le salaire ne dépend pas de la catégorie raciale ? Eh bien, pas vraiment non plus. En gros, on n'a pas rejeté l'idée que les deux variables sont indépendantes, et les variations observées peuvent être dues à des fluctuations d'échantillonnage... ou pas.\n\nEt si la p-valeur avait été inférieure à 0,05 ? On aurait pu rejeter H0 l'hypothèse d'indépendance et on aurait considéré qu'un lien existe entre les deux variables.\n\nOn peut vérifier la p-valeur calculée comme ceci :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi$p.value\n```\n:::\n\n\n\n:::\n\nOn pose l'hypothèse nulle (H0) que les deux variables sont indépendantes. On fixe un seuil de significativité pour la p-valeur égal à 0,05, en dessous de laquelle on rejette l'hypothèse d'indépendance et à ce moment là on considère qu'un lien existe entre les variables :\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab<-Salaires |>\n  freqtable(race, salaire_quint)\nchi<-chisq.test(tab)\nchi\n```\n:::\n\n\n\n\nLa p-valeur est supérieure à 0,05, donc on ne peut pas rejeter H0 et on ne peut pas conclure qu'un lien existe entre les deux variables.\n\n::: {.callout-note title=\"Exercice\"}\nTester l'hypothèse d'un lien entre le sexe et les quintiles de salaire.\n:::\n\nON MET ICI le RECODAGE DES VARIABLES QUALIS\n\n## Exercices\n\nON ALLEGE\n\n::: {.callout-note title=\"Exercice\" icon=\"false\"}\n1.  Créer une variable haut_revenu qui vaut \"oui\" si un individu appartient aux 10 % les mieux rémunérés (salaire ≥ 9e décile) et \"non\" sinon. Calculer la proportion d’individus ayant un haut revenu pour le genre et la race, calculer les V de Cramer et réaliser des tests du khi-deux. Réaliser des diagrammes à barres. Qui sont les plus présents en haut de l'échelle salariale ?\n\n2.  Recoder la variable âge en quatre groupes :\n\n-   Moins de 30 ans\n\n-   30-44 ans\n\n-   45-59 ans\n\n-   60 ans et plus\n\n3.  Pour chaque groupe d’âge, calculer la médiane et les quartiles du salaire et de l’expérience. Représenter ces distributions avec des boxplots. Observe-t-on un effet d’âge linéaire ?\n\n4.  Décrire à l'aide d'un tableau croisé la distribution de l'âge en fonction des hauts revenus. Calculer le V de Cramer et réaliser un test du khi-deux. Réaliser un diagramme à barres. Qui sont les plus présents en haut de l'échelle salariale ?\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}